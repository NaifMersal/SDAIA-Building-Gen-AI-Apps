<!DOCTYPE html>
<html lang="en"><head>
<script src="03_observability_and_evaluation_files/libs/clipboard/clipboard.min.js"></script>
<script src="03_observability_and_evaluation_files/libs/quarto-html/tabby.min.js"></script>
<script src="03_observability_and_evaluation_files/libs/quarto-html/popper.min.js"></script>
<script src="03_observability_and_evaluation_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="03_observability_and_evaluation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="03_observability_and_evaluation_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="03_observability_and_evaluation_files/libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.26">

  <meta name="dcterms.date" content="2026-02-27">
  <title>Observability &amp; Evaluation</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="03_observability_and_evaluation_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="03_observability_and_evaluation_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="03_observability_and_evaluation_files/libs/revealjs/dist/theme/quarto-11fb225df25554060309039e467d350a.css">
  <link href="03_observability_and_evaluation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="03_observability_and_evaluation_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="03_observability_and_evaluation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="03_observability_and_evaluation_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="03_observability_and_evaluation_files/libs/quarto-diagram/mermaid.min.js"></script>
  <script src="03_observability_and_evaluation_files/libs/quarto-diagram/mermaid-init.js"></script>
  <link href="03_observability_and_evaluation_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA4MCA4MCI+DQogIDxkZWZzPg0KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iYSIgeDE9Ii0xLjkxMSIgeDI9IjIuOTg1IiB5MT0iLS44NDEiIHkyPSIxLjQxNCIgZ3JhZGllbnRVbml0cz0ib2JqZWN0Qm91bmRpbmdCb3giPg0KICAgICAgPHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjOTlkNjMzIi8+DQogICAgICA8c3RvcCBvZmZzZXQ9Ii41IiBzdG9wLWNvbG9yPSIjM2M5Ii8+DQogICAgICA8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMyNzM0NzAiLz4NCiAgICA8L2xpbmVhckdyYWRpZW50Pg0KICAgIDxsaW5lYXJHcmFkaWVudCBocmVmPSIjYSIgaWQ9ImQiIHgxPSItMy41NjkiIHgyPSIxLjMyOCIgeTE9Ii0xLjYwNSIgeTI9Ii42NTEiLz4NCiAgICA8bGluZWFyR3JhZGllbnQgaHJlZj0iI2EiIGlkPSJlIiB4MT0iLTMuMDQ3IiB4Mj0iMS44NDkiIHkxPSItLjkwNCIgeTI9IjEuMzUyIi8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNhIiBpZD0iZiIgeDE9Ii0yLjg5IiB4Mj0iMi4wMDciIHkxPSItMS4yOTIiIHkyPSIuOTY0Ii8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNhIiBpZD0iZyIgeDE9Ii0yLjQiIHgyPSIyLjQ5NyIgeTE9Ii0xLjA2NiIgeTI9IjEuMTg5Ii8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNhIiBpZD0iaCIgeDE9Ii0uOTkyIiB4Mj0iMi42NzkiIHkxPSItLjQxOCIgeTI9IjEuMjczIi8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNhIiBpZD0iaSIgeDE9Ii0xLjUxMiIgeDI9IjIuMTU5IiB5MT0iLS4xOTciIHkyPSIxLjQ5NSIvPg0KICAgIDxsaW5lYXJHcmFkaWVudCBocmVmPSIjYSIgaWQ9ImoiIHgxPSItLjkxNCIgeDI9IjIuNzU4IiB5MT0iLjA3OSIgeTI9IjEuNzcxIi8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNhIiBpZD0iayIgeDE9Ii0zLjQwNSIgeDI9IjEuNDkzIiB5MT0iLTEuMDY4IiB5Mj0iMS4xODciLz4NCiAgICA8bGluZWFyR3JhZGllbnQgaHJlZj0iI2EiIGlkPSJsIiB4MT0iLjM0NyIgeDI9IjMuMjg1IiB5MT0iLjE5OSIgeTI9IjEuNTUyIi8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNhIiBpZD0ibSIgeDE9Ii0uOTA1IiB4Mj0iMi43NjciIHkxPSIuMDgzIiB5Mj0iMS43NzUiLz4NCiAgICA8bGluZWFyR3JhZGllbnQgaHJlZj0iI2EiIGlkPSJuIiB4MT0iLTIuMTE5IiB4Mj0iMi43NzgiIHkxPSItLjQ3NiIgeTI9IjEuNzc5Ii8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNhIiBpZD0ibyIgeDE9Ii01LjY0NCIgeDI9Ii40ODYiIHkxPSItMi45OTgiIHkyPSIuNzQxIi8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNhIiBpZD0icCIgeDE9Ii0zLjQ5NSIgeDI9IjIuNjM2IiB5MT0iLTEuNjg3IiB5Mj0iMi4wNTMiLz4NCiAgICA8bGluZWFyR3JhZGllbnQgaHJlZj0iI2EiIGlkPSJxIiB4MT0iLTEuNDIyIiB4Mj0iMy4xNzUiIHkxPSItLjkyMyIgeTI9IjEuODgyIi8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNhIiBpZD0iciIgeDE9Ii0zLjMwNiIgeDI9IjIuODI1IiB5MT0iLTIuMDcyIiB5Mj0iMS42NjgiLz4NCiAgICA8bGluZWFyR3JhZGllbnQgaHJlZj0iI2EiIGlkPSJzIiB4MT0iLTEuNjgzIiB4Mj0iMi45MTQiIHkxPSItMS4wODEiIHkyPSIxLjcyMyIvPg0KICAgIDxsaW5lYXJHcmFkaWVudCBocmVmPSIjYSIgaWQ9InQiIHgxPSItMS4xNTgiIHgyPSIyLjUyMSIgeTE9Ii0uMjYxIiB5Mj0iMS45ODMiLz4NCiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImIiIHgxPSIuMjYxIiB4Mj0iLjYyNCIgeTE9IjMuNTYiIHkyPSItMS40NjkiIGdyYWRpZW50VW5pdHM9Im9iamVjdEJvdW5kaW5nQm94Ij4NCiAgICAgIDxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iIzZjZiIvPg0KICAgICAgPHN0b3Agb2Zmc2V0PSIuNSIgc3RvcC1jb2xvcj0iIzYyNThhNiIvPg0KICAgICAgPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjMjczNDcwIi8+DQogICAgPC9saW5lYXJHcmFkaWVudD4NCiAgICA8bGluZWFyR3JhZGllbnQgaHJlZj0iI2IiIGlkPSJ1IiB4MT0iLjE2MyIgeDI9Ii41MjYiIHkxPSI0LjkyNCIgeTI9Ii0uMTAzIi8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNiIiBpZD0idiIgeDE9Ii4zODYiIHgyPSIuNjU4IiB5MT0iMS44MjUiIHkyPSItMS45NDUiLz4NCiAgICA8bGluZWFyR3JhZGllbnQgaHJlZj0iI2IiIGlkPSJ3IiB4MT0iLjI1MiIgeDI9Ii42MTUiIHkxPSI0LjE4MiIgeTI9Ii0uODQ1Ii8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNiIiBpZD0ieCIgeDE9Ii40MTciIHgyPSIuNjg5IiB5MT0iMS45IiB5Mj0iLTEuODciLz4NCiAgICA8bGluZWFyR3JhZGllbnQgaHJlZj0iI2IiIGlkPSJ5IiB4MT0iLjQ4NSIgeDI9Ii43MDMiIHkxPSIuOTU2IiB5Mj0iLTIuMDYiLz4NCiAgICA8bGluZWFyR3JhZGllbnQgaHJlZj0iI2IiIGlkPSJ6IiB4MT0iLjM3NyIgeDI9Ii42NDkiIHkxPSIyLjQ1NSIgeTI9Ii0xLjMxNCIvPg0KICAgIDxsaW5lYXJHcmFkaWVudCBocmVmPSIjYiIgaWQ9IkEiIHgxPSIuMTk5IiB4Mj0iLjU2MiIgeTE9IjQuOTIyIiB5Mj0iLS4xMDUiLz4NCiAgICA8bGluZWFyR3JhZGllbnQgaHJlZj0iI2IiIGlkPSJCIiB4MT0iLjQzNyIgeDI9Ii43MDkiIHkxPSIxLjYyNSIgeTI9Ii0yLjE0NSIvPg0KICAgIDxsaW5lYXJHcmFkaWVudCBocmVmPSIjYiIgaWQ9IkMiIHgxPSIuMjYxIiB4Mj0iLjYyNCIgeTE9IjQuMDU1IiB5Mj0iLS45NzIiLz4NCiAgICA8bGluZWFyR3JhZGllbnQgaHJlZj0iI2IiIGlkPSJEIiB4MT0iLjUiIHgyPSIuNSIgeTE9IjMuMDQ1IiB5Mj0iLTEuOTI3Ii8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNiIiBpZD0iRSIgeDE9Ii41IiB4Mj0iLjUiIHkxPSI0LjkwMSIgeTI9Ii0uMDcyIi8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNiIiBpZD0iRiIgeDE9Ii41IiB4Mj0iLjUiIHkxPSIyLjQzNSIgeTI9Ii0xLjI5NiIvPg0KICAgIDxsaW5lYXJHcmFkaWVudCBocmVmPSIjYiIgaWQ9IkciIHgxPSIuNSIgeDI9Ii41IiB5MT0iLjkzNCIgeTI9Ii0yLjA1Ii8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNiIiBpZD0iSCIgeDE9Ii41IiB4Mj0iLjUiIHkxPSIzLjc4NSIgeTI9Ii0xLjE4NyIvPg0KICAgIDxsaW5lYXJHcmFkaWVudCBocmVmPSIjYiIgaWQ9IkkiIHgxPSIuNSIgeDI9Ii41IiB5MT0iMS44MDkiIHkyPSItMS45MjEiLz4NCiAgICA8bGluZWFyR3JhZGllbnQgaHJlZj0iI2IiIGlkPSJKIiB4MT0iLjUiIHgyPSIuNSIgeTE9IjMuMDQ2IiB5Mj0iLTEuOTI4Ii8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNiIiBpZD0iSyIgeDE9Ii41IiB4Mj0iLjUiIHkxPSIyLjc5NCIgeTI9Ii0yLjE3NyIvPg0KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iYyIgeDE9IjUuMDEiIHgyPSItMi4yNzciIHkxPSItMS4zODMiIHkyPSIyLjAzOSIgZ3JhZGllbnRVbml0cz0ib2JqZWN0Qm91bmRpbmdCb3giPg0KICAgICAgPHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjZmRiZDRkIi8+DQogICAgICA8c3RvcCBvZmZzZXQ9Ii41IiBzdG9wLWNvbG9yPSIjZjYzIi8+DQogICAgICA8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMyNzM0NzAiLz4NCiAgICA8L2xpbmVhckdyYWRpZW50Pg0KICAgIDxsaW5lYXJHcmFkaWVudCBocmVmPSIjYyIgaWQ9IkwiIHgxPSIyLjIzOSIgeDI9Ii0yLjEzNCIgeTE9Ii0uMDgyIiB5Mj0iMS45NzEiLz4NCiAgICA8bGluZWFyR3JhZGllbnQgaHJlZj0iI2MiIGlkPSJNIiB4MT0iNi4wOTgiIHgyPSItMS4xOTEiIHkxPSItMS44OTMiIHkyPSIxLjUyOCIvPg0KICAgIDxsaW5lYXJHcmFkaWVudCBocmVmPSIjYyIgaWQ9Ik4iIHgxPSIzLjM4NCIgeDI9Ii0yLjA4MSIgeTE9Ii0xLjA4OCIgeTI9IjEuNDc3Ii8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNjIiBpZD0iTyIgeDE9IjIuNzgiIHgyPSItMi42ODYiIHkxPSItLjgwNSIgeTI9IjEuNzYxIi8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNjIiBpZD0iUCIgeDE9IjcuMDc0IiB4Mj0iLS4yMTIiIHkxPSItMi4zNTMiIHkyPSIxLjA2OSIvPg0KICAgIDxsaW5lYXJHcmFkaWVudCBocmVmPSIjYyIgaWQ9IlEiIHgxPSI1LjA3NSIgeDI9Ii0yLjIxMSIgeTE9Ii0xLjQxNCIgeTI9IjIuMDA4Ii8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNjIiBpZD0iUiIgeDE9IjUuNzM2IiB4Mj0iLTEuNTUiIHkxPSItMi4xOTQiIHkyPSIxLjIyOCIvPg0KICAgIDxsaW5lYXJHcmFkaWVudCBocmVmPSIjYyIgaWQ9IlMiIHgxPSIyLjA4MSIgeDI9Ii0xLjc4MSIgeTE9Ii0uMDQ3IiB5Mj0iMS45Ii8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNjIiBpZD0iVCIgeDE9Ii43MjkiIHgyPSItMi4zNjEiIHkxPSIuMTM1IiB5Mj0iMS42OTIiLz4NCiAgICA8bGluZWFyR3JhZGllbnQgaHJlZj0iI2MiIGlkPSJVIiB4MT0iMi43MTciIHgyPSItMi40MzMiIHkxPSItLjg2OCIgeTI9IjEuNzI4Ii8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNjIiBpZD0iViIgeDE9IjEuNTE3IiB4Mj0iLTIuMzQ3IiB5MT0iLS4yNjIiIHkyPSIxLjY4NCIvPg0KICAgIDxsaW5lYXJHcmFkaWVudCBocmVmPSIjYyIgaWQ9IlciIHgxPSIzLjU0NCIgeDI9Ii0xLjYwNiIgeTE9Ii0xLjI4NCIgeTI9IjEuMzEyIi8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNjIiBpZD0iWCIgeDE9IjIuNjMxIiB4Mj0iLTEuMjMzIiB5MT0iLS4zMjQiIHkyPSIxLjYyMyIvPg0KICAgIDxsaW5lYXJHcmFkaWVudCBocmVmPSIjYyIgaWQ9IlkiIHgxPSIyLjAwMyIgeDI9Ii0xLjg2IiB5MT0iLS4wMDciIHkyPSIxLjk0Ii8+DQogICAgPGxpbmVhckdyYWRpZW50IGhyZWY9IiNjIiBpZD0iWiIgeDE9IjQuMTI1IiB4Mj0iLTEuMDI1IiB5MT0iLTEuMDc3IiB5Mj0iMS41MTgiLz4NCiAgICA8bGluZWFyR3JhZGllbnQgaHJlZj0iI2MiIGlkPSJhYSIgeDE9IjMuMDIyIiB4Mj0iLTIuMTI3IiB5MT0iLTEuMDIxIiB5Mj0iMS41NzQiLz4NCiAgICA8bGluZWFyR3JhZGllbnQgaHJlZj0iI2MiIGlkPSJhYiIgeDE9IjQuNjgxIiB4Mj0iLS40NjkiIHkxPSItMS44NTciIHkyPSIuNzM4Ii8+DQogIDwvZGVmcz4NCiAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMy44IDEpIj4NCiAgPHBhdGggZmlsbD0iIzNjOSIgZD0ibTM2LjA0MSAyNi41My0xMS40NDggNi42MTF2MTMuMjJsMTEuNDQ4IDYuNjEyIDExLjQ0Ni02LjYwOFYzMy4xNDFaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjYSkiIGQ9Ik03MS40NjQgMjAuOTF2Ny45MzJsLTYuODctMy45NjVaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjZCkiIGQ9Ik02NC4yNDkgNTIuOTdsNi44NjkgMy45NjV2LTcuOTNaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjZSkiIGQ9Im02OC4xIDQ2LjM1OSAtNi44NjkgMy45Njd2LTcuOTMyWiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI2YpIiBkPSJNNzIuMzkyIDM1LjM3djcuOTMybC02Ljg2OSAtMy45NjVaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjZykiIGQ9Ik01Ni42NTEgNTYuODQ3djcuOTMybC02Ljg2OSAtMy45NjVaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjaCkiIGQ9Im01Ny43OTQgNTEuNjQzIC05LjE2IC01LjI4NiA5LjE2IC01LjI5WiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI2kpIiBkPSJtNTcuNzk1IDUyLjk3IC05LjE2IDUuMjlWNDcuNjg0WiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI2opIiBkPSJtNTcuNzkyIDM5Ljc0OSAtOS4xNTggNS4yODZ2LTEwLjU3MloiLz4NCiAgPHBhdGggZmlsbD0idXJsKCNrKSIgZD0ibTU4LjUgNzAuMzE4IC02Ljg2OCAzLjk2N3YtNy45MzJaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjbCkiIGQ9Im00Ny40ODcgNDYuMzYxIC0xMS40NDYgLTYuNjEyIDExLjQ0NiAtNi42MTFaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjbSkiIGQ9Im00Ni4zNDQgNjEuMDc3IC05LjE1OCA1LjI4NnYtMTAuNTcyWiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI24pIiBkPSJtNDUuMTk5IDc0LjAzNSAtNi44NjggMy45NjV2LTcuOTMyWiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI28pIiBkPSJtNzAuMDIxIDYxLjc3NSAtNi44NjkgMy45Njd2LTcuOTMyWiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI3ApIiBkPSJtNjguMSAzMy4xNDIgLTYuODY5IDMuOTY3di03LjkzMloiLz4NCiAgPHBhdGggZmlsbD0idXJsKCNxKSIgZD0iTTU3Ljc5NCAyNy44NTJ2MTAuNTc2bC05LjE2IC01LjI5WiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI3IpIiBkPSJNNDUuMjAyIDYyLjg5MXY3LjkzMmwtNi44NjkgLTMuOTY3WiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI3MpIiBkPSJtNDYuMzQzIDU5Ljc1NiAtOS4xNTcgLTUuMjg2IDkuMTU3IC01LjI5WiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI3QpIiBkPSJtMzYuMDQxIDM5Ljc1IDExLjQ0NiA2LjYxMiAtMTEuNDQ2IDYuNjA4WiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI2IpIiBkPSJtNjkuMzM0IDE3LjAzMSAtNi44NjkgMy45NjV2LTcuOTNaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjdSkiIGQ9Im01OC4wODIgNS40NiAtNi44NzEgMy45Njd2LTcuOTMyWiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI3YpIiBkPSJtNTcuNzk2IDI2LjUyOSAtOS4xNjIgNS4yODZWMjEuMjQxWiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI3cpIiBkPSJtNDUuMiAxNC41NDUgLTYuODY5IC0zLjk2NSA2Ljg2OSAtMy45NjdaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjeCkiIGQ9Ik00Ni4zNDQgMTkuNzQ0VjMwLjMxOWwtOS4xNTggLTUuMjg2WiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI3kpIiBkPSJNMzYuMDQxIDI2LjUzdjEzLjIyTDI0LjU5MyAzMy4xNDFaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjeikiIGQ9Im0zNC44OTcgMjMuNzA5IC05LjE1OCAtNS4yODYgOS4xNTggLTUuMjlaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjQSkiIGQ9Im0zMy43NSA3LjkzMiAtNi44NyAtMy45NjUgNi44NyAtMy45NjdaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjQikiIGQ9Im0yMy40NDkgMzEuODE2IC05LjE1OCAtNS4yOSA5LjE1OCAtNS4yODVaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjQykiIGQ9Ik0xOS43NiA2LjAzOXY3LjkzMmwtNi44NjkgLTMuOTY1WiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI0QpIiBkPSJtNTYuNjQ3IDIyLjY1MSAtNi44NzEgLTMuOTY3IDYuODcxIC0zLjk2N1oiLz4NCiAgPHBhdGggZmlsbD0idXJsKCNFKSIgZD0ibTQ1LjIgMy45NjcgLTYuODY5IDMuOTY1di03LjkzMloiLz4NCiAgPHBhdGggZmlsbD0idXJsKCNGKSIgZD0ibTQ2LjM0NCAxOC40MTcgLTkuMTU4IDUuMjg2di0xMC41NjhaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjRykiIGQ9Im00Ny40ODcgMzMuMTQxIC0xMS40NDYgNi42MTF2LTEzLjIyWiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI0gpIiBkPSJtMzMuNzUzIDEyLjgxNCAtNi44NzEgMy45Njd2LTcuOTMyWiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI0kpIiBkPSJtMzQuODk2IDI1LjAzMyAtOS4xNTggNS4yODZ2LTEwLjU3NVoiLz4NCiAgPHBhdGggZmlsbD0idXJsKCNKKSIgZD0ibTIyLjMgMTguNjg0IC02Ljg3IDMuOTY1di03LjkzWiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI0spIiBkPSJtNy41NTYgMjQuNjM3IC02Ljg3IC0zLjk2NSA2Ljg3IC0zLjk2N1oiLz4NCiAgPHBhdGggZmlsbD0idXJsKCNjKSIgZD0ibTMzLjc1MSA3OC4wMDEgLTYuODcxIC0zLjk2NSA2Ljg3MSAtMy45NjdaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjTCkiIGQ9Ik0zNi4wNDEgMzkuNzV2MTMuMjJsLTExLjQ0OCAtNi42MTJaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjTSkiIGQ9Ik0yMi4zIDY2Ljc2M3Y3LjkzMmwtNi44NyAtMy45NjZaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjTikiIGQ9Im0yMy40NDkgNDYuMzYyIC05LjE1OCA1LjI4NnYtMTAuNTc2WiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI08pIiBkPSJtMjMuNDQ5IDMzLjE0MiAtOS4xNTggNS4yOXYtMTAuNThaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjUCkiIGQ9Ik05LjYxNiA1OS40MDF2Ny45M2wtNi44NzEgLTMuOTY1WiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI1EpIiBkPSJNMTAuODUxIDI4Ljg5OXY3LjkzMmwtNi44NzEgLTMuOTY1WiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI1IpIiBkPSJtNi44NzEgNDAuMDkzIC02Ljg3MSAzLjk2NXYtNy45M1oiLz4NCiAgPHBhdGggZmlsbD0idXJsKCNTKSIgZD0ibTM0Ljg5NCA2Ni4zNjcgLTkuMTYgLTUuMjg2IDkuMTYgLTUuMjlaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjVCkiIGQ9Im0zNi4wNDEgMzkuNzUgLTExLjQ0OCA2LjYwOHYtMTMuMjJaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjVSkiIGQ9Im0zMy43NSA2Ny40MjUgLTYuODcxIDMuOTY3di03LjkzMloiLz4NCiAgPHBhdGggZmlsbD0idXJsKCNWKSIgZD0ibTM0Ljg5MiA1NC40NjcgLTkuMTU3IDUuMjl2LTEwLjU4MloiLz4NCiAgPHBhdGggZmlsbD0idXJsKCNXKSIgZD0ibTIyLjI5OSA2MC44MTQgLTYuODY5IDMuOTY1di03LjkzWiIvPg0KICA8cGF0aCBmaWxsPSJ1cmwoI1gpIiBkPSJNMjMuNDQ5IDQ3LjY4M3YxMC41NzNsLTkuMTU4IC01LjI4NloiLz4NCiAgPHBhdGggZmlsbD0idXJsKCNZKSIgZD0iTTIzLjQ0OSAzNC40NTl2MTAuNTczbC05LjE1OCAtNS4yODNaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjWikiIGQ9Im0xMC44NSA1MC4zMjYgLTYuODcxIC0zLjk2NyA2Ljg3MSAtMy45NjVaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjYWEpIiBkPSJtNy4xNDUgMjYuNTMxIC02Ljg2OSAzLjk2NXYtNy45MzJaIi8+DQogIDxwYXRoIGZpbGw9InVybCgjYWIpIiBkPSJtNy41NTYgNTMuNDUyIC02Ljg3MSAzLjk2NXYtNy45MzVaIi8+DQogIDwvZz4NCjwvc3ZnPg0K">

</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="../../slides_template/assets/anim.svg" data-background-opacity="0.15" data-background-size="cover" class="quarto-title-block center">
  <h1 class="title">Observability &amp; Evaluation</h1>
  <p class="subtitle">AI Agents &amp; Orchestration — Session 3</p>

<div class="quarto-title-authors">
</div>

  <p class="date">2026-02-27</p>
</section>
<section>
<section id="a.-the-black-box-problem" class="title-slide slide level1 sdaia-dark center" data-background-gradient="linear-gradient(135deg, #1C355E, #00C9A7)">
<h1>A. The Black Box Problem</h1>
<p>You cannot ship what you cannot trace</p>
</section>
<section id="agenda" class="slide level2">
<h2>Agenda</h2>
<ul>
<li><strong>A. The Black Box Problem</strong> — Why agent debugging is different (~10 min)</li>
<li><strong>B. Structured Tracing</strong> — Seeing inside the agent’s brain (~15 min)</li>
<li><strong>C. Loop Detection</strong> — Catching agents that spin in circles (~15 min)</li>
<li><strong>D. Cost Tracking</strong> — Monitoring spend per query (~10 min)</li>
<li><strong>E. DeepEval for Agents</strong> — Production-grade evaluation (~20 min)</li>
<li><strong>F. Wrap-up</strong> — Key takeaways &amp; lab preview (~5 min)</li>
</ul>
</section>
<section id="traditional-vs-agent-debugging" class="slide level2 smaller">
<h2>Traditional vs Agent Debugging</h2>
<table class="caption-top">
<colgroup>
<col style="width: 57%">
<col style="width: 42%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Traditional Debugging</th>
<th style="text-align: left;">Agent Debugging</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Same input -&gt; same output</td>
<td style="text-align: left;">Same input -&gt; different outputs</td>
</tr>
<tr class="even">
<td style="text-align: left;">Stack trace shows exact failure</td>
<td style="text-align: left;">Failure emerges over multiple steps</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Unit tests with <code>assertEqual</code></td>
<td style="text-align: left;">Subjective quality evaluation</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fixed cost per execution</td>
<td style="text-align: left;">Variable cost (1-50 LLM calls)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Errors crash the program</td>
<td style="text-align: left;">Errors may be silently “reasoned away”</td>
</tr>
</tbody>
</table>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>The Core Problem</strong></p>
</div>
<div class="callout-content">
<p>An agent might technically succeed (no crash, produces an answer) while being <strong>completely wrong</strong>. Or it might spend $0.50 on a $0.02 question. You can’t fix what you can’t see.</p>
</div>
</div>
</div>
</div>
</section>
<section id="five-ways-agents-fail" class="slide level2">
<h2>Five Ways Agents Fail</h2>
<ol type="1">
<li class="fragment"><strong>Prompt ambiguity</strong> — the agent didn’t understand the task</li>
<li class="fragment"><strong>Tool misuse</strong> — right tool, wrong arguments</li>
<li class="fragment"><strong>Formatting errors</strong> — tried to format JSON, failed</li>
<li class="fragment"><strong>Infinite loops</strong> — kept searching “Python” 50 times</li>
<li class="fragment"><strong>Hallucination</strong> — confidently lied about a search result it never saw</li>
</ol>
<div class="fragment">
<blockquote>
<p><strong>Production Tip:</strong> Never deploy an agent without tracing. Costs can explode if an agent enters an infinite loop.</p>
</blockquote>
</div>
</section></section>
<section>
<section id="b.-structured-tracing" class="title-slide slide level1 sdaia-dark center" data-background-gradient="linear-gradient(135deg, #1C355E, #9B8EC0)">
<h1>B. Structured Tracing</h1>
<p>Every step, captured and queryable</p>
</section>
<section id="what-a-good-trace-captures" class="slide level2">
<h2>What a Good Trace Captures</h2>
<p>For <strong>every step</strong> in the agent loop:</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Trace ID (unique per request)</li>
<li>Step number</li>
<li>Agent’s reasoning (LLM content)</li>
<li>Tool calls (name + arguments)</li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>Tool results</li>
<li>Token usage (input/output)</li>
<li>Cost per step (USD)</li>
<li>Duration (milliseconds)</li>
</ul>
</div></div>
<div class="fragment">
<pre><code>[Step 3] (450ms, $0.0042)
  Reasoning: "The search returned results about Paris. Let me..."
  Tool: search({"query": "population of Paris 2024"})
  Result: "The population of Paris is approximately 2.1 million..."</code></pre>
</div>
</section>
<section id="the-trace-data-model" class="slide level2 smaller">
<h2>The Trace Data Model</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" data-code-line-numbers="|1-5|7-13|15-22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href=""></a><span class="at">@dataclass</span></span>
<span id="cb2-2"><a href=""></a><span class="kw">class</span> ToolCallRecord:</span>
<span id="cb2-3"><a href=""></a>    tool_name: <span class="bu">str</span></span>
<span id="cb2-4"><a href=""></a>    tool_input: <span class="bu">dict</span></span>
<span id="cb2-5"><a href=""></a>    tool_output: <span class="bu">str</span></span>
<span id="cb2-6"><a href=""></a>    duration_ms: <span class="bu">float</span></span>
<span id="cb2-7"><a href=""></a></span>
<span id="cb2-8"><a href=""></a><span class="at">@dataclass</span></span>
<span id="cb2-9"><a href=""></a><span class="kw">class</span> AgentStep:</span>
<span id="cb2-10"><a href=""></a>    step_number: <span class="bu">int</span></span>
<span id="cb2-11"><a href=""></a>    reasoning: Optional[<span class="bu">str</span>]</span>
<span id="cb2-12"><a href=""></a>    tool_calls: <span class="bu">list</span>[ToolCallRecord]</span>
<span id="cb2-13"><a href=""></a>    input_tokens: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-14"><a href=""></a>    output_tokens: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-15"><a href=""></a>    cost_usd: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb2-16"><a href=""></a></span>
<span id="cb2-17"><a href=""></a><span class="at">@dataclass</span></span>
<span id="cb2-18"><a href=""></a><span class="kw">class</span> Trace:</span>
<span id="cb2-19"><a href=""></a>    trace_id: <span class="bu">str</span></span>
<span id="cb2-20"><a href=""></a>    agent_name: <span class="bu">str</span></span>
<span id="cb2-21"><a href=""></a>    steps: <span class="bu">list</span>[AgentStep]</span>
<span id="cb2-22"><a href=""></a>    status: <span class="bu">str</span>  <span class="co"># "running", "completed", "failed", "loop_detected"</span></span>
<span id="cb2-23"><a href=""></a>    total_cost_usd: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="the-agenttracer-class" class="slide level2 smaller">
<h2>The AgentTracer Class</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href=""></a><span class="kw">class</span> AgentTracer:</span>
<span id="cb3-2"><a href=""></a>    <span class="kw">def</span> start_trace(<span class="va">self</span>, agent_name, query, model) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb3-3"><a href=""></a>        <span class="co">"""Start a new trace. Returns trace_id."""</span></span>
<span id="cb3-4"><a href=""></a></span>
<span id="cb3-5"><a href=""></a>    <span class="kw">def</span> log_step(<span class="va">self</span>, trace_id, step: AgentStep):</span>
<span id="cb3-6"><a href=""></a>        <span class="co">"""Log a completed step — accumulates tokens and cost."""</span></span>
<span id="cb3-7"><a href=""></a></span>
<span id="cb3-8"><a href=""></a>    <span class="kw">def</span> end_trace(<span class="va">self</span>, trace_id, output, status<span class="op">=</span><span class="st">"completed"</span>):</span>
<span id="cb3-9"><a href=""></a>        <span class="co">"""Mark trace as complete."""</span></span>
<span id="cb3-10"><a href=""></a></span>
<span id="cb3-11"><a href=""></a>    <span class="kw">def</span> get_trace_json(<span class="va">self</span>, trace_id) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb3-12"><a href=""></a>        <span class="co">"""Export trace as JSON for debugging."""</span></span>
<span id="cb3-13"><a href=""></a></span>
<span id="cb3-14"><a href=""></a>    <span class="kw">def</span> print_summary(<span class="va">self</span>, trace_id):</span>
<span id="cb3-15"><a href=""></a>        <span class="co">"""Human-readable trace summary."""</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="fragment">
<p>In production, this would send data to <strong>Datadog</strong>, <strong>LangSmith</strong>, or <strong>Arize</strong>. For this course, we log to console and export to JSON.</p>
</div>
</section>
<section id="trace-output-example" class="slide level2 smaller">
<h2>Trace Output Example</h2>
<pre><code>============================================================
TRACE SUMMARY: a1b2c3d4
============================================================
Agent: react_agent | Model: gpt-4o
Status: completed
Query: What is the population of the capital of France?

Steps (3 total):
------------------------------------------------------------
  Step 1: 1200ms, $0.0085 -&gt; search
  Step 2: 980ms,  $0.0062 -&gt; search
  Step 3: 450ms,  $0.0031 (no tools)
------------------------------------------------------------
Total Tokens: 2847 input + 312 output = 3159
Total Cost:   $0.0178
Total Time:   2630ms

Answer: The population of Paris is approximately 2.1 million.
============================================================</code></pre>
</section></section>
<section>
<section id="c.-loop-detection" class="title-slide slide level1 sdaia-dark center" data-background-gradient="linear-gradient(135deg, #1C355E, #FF7A5C)">
<h1>C. Loop Detection</h1>
<p>Catching agents that spin in circles</p>
</section>
<section id="the-infinite-loop-problem" class="slide level2">
<h2>The Infinite Loop Problem</h2>
<p>An agent calls <code>search("python tutorial")</code>, gets a result, then calls <code>search("python tutorial")</code> again. And again. And again.</p>
<div class="fragment">
<p><strong>Why it happens:</strong></p>
<ul>
<li>The model doesn’t “understand” the result satisfied the query</li>
<li>The tool returns an error, and the agent retries with the same arguments</li>
<li>The prompt is ambiguous, so the agent keeps trying variations</li>
</ul>
</div>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Cost Impact</strong></p>
</div>
<div class="callout-content">
<p>A looping agent can burn through hundreds of API calls at $0.01-0.05 each. A single bad query can cost $5+ before max_steps kicks in.</p>
</div>
</div>
</div>
</div>
</section>
<section id="three-detection-strategies" class="slide level2">
<h2>Three Detection Strategies</h2>
<div class="cell" data-reveal="true" data-fig-width="9" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    TC["Tool Call"] --&gt; E["Exact Match&lt;br/&gt;Same tool + same args"]
    TC --&gt; F["Fuzzy Match&lt;br/&gt;Similar args (Jaccard)"]
    TC --&gt; S["Output Stagnation&lt;br/&gt;Similar outputs repeated"]

    style E fill:#FF7A5C,stroke:#1C355E,color:#1C355E
    style F fill:#9B8EC0,stroke:#1C355E,color:#1C355E
    style S fill:#00C9A7,stroke:#1C355E,color:#1C355E
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="strategy-1-exact-match" class="slide level2">
<h2>Strategy 1: Exact Match</h2>
<p>Same tool + identical arguments repeated N times.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href=""></a><span class="co"># Before executing each tool call:</span></span>
<span id="cb5-2"><a href=""></a>count <span class="op">=</span> tool_history.count((current_tool_name, current_args_string))</span>
<span id="cb5-3"><a href=""></a></span>
<span id="cb5-4"><a href=""></a><span class="cf">if</span> count <span class="op">&gt;=</span> exact_threshold:</span>
<span id="cb5-5"><a href=""></a>    <span class="cf">return</span> LoopDetected(confidence<span class="op">=</span><span class="fl">1.0</span>)  <span class="co"># 100% — always a loop</span></span>
<span id="cb5-6"><a href=""></a></span>
<span id="cb5-7"><a href=""></a>tool_history.append((current_tool_name, current_args_string))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Confidence:</strong> 100% — this is always a loop.</p>
</section>
<section id="strategy-2-fuzzy-match" class="slide level2">
<h2>Strategy 2: Fuzzy Match</h2>
<p>Similar (but not identical) tool calls — catches minor rephrasing.</p>
<pre><code>Jaccard(A, B) = |A ∩ B| / |A ∪ B|

"python tutorial basics" ∩ "basics python tutorial" = {python, tutorial, basics}
→ |intersection| / |union| = 3/3 = 1.0  ← loop detected!

"python tutorial" ∩ "python guide" = {python}
→ 1 / 3 = 0.33  ← different query, not a loop</code></pre>
<div class="fragment">
<ul>
<li>Threshold: 0.8 — catches rephrasings, ignores truly different queries</li>
</ul>
</div>
</section>
<section id="strategy-3-output-stagnation" class="slide level2">
<h2>Strategy 3: Output Stagnation</h2>
<p>The agent keeps producing similar responses — not making progress.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href=""></a><span class="co"># Compare pairwise similarity of last N agent outputs</span></span>
<span id="cb7-2"><a href=""></a>recent_outputs <span class="op">=</span> output_history[<span class="op">-</span>stagnation_window:]</span>
<span id="cb7-3"><a href=""></a></span>
<span id="cb7-4"><a href=""></a><span class="cf">if</span> avg_pairwise_similarity(recent_outputs) <span class="op">&gt;=</span> threshold:</span>
<span id="cb7-5"><a href=""></a>    <span class="cf">return</span> LoopDetected(strategy<span class="op">=</span><span class="st">"stagnation"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="the-circuit-breaker-pattern" class="slide level2 smaller">
<h2>The Circuit Breaker Pattern</h2>
<p>Combine loop detection with the agent loop to <strong>break</strong> infinite cycles:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8" data-code-line-numbers="|5-9|11-12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href=""></a><span class="cf">for</span> step <span class="kw">in</span> <span class="bu">range</span>(max_steps):</span>
<span id="cb8-2"><a href=""></a>    <span class="co"># ... get LLM response, extract tool calls ...</span></span>
<span id="cb8-3"><a href=""></a></span>
<span id="cb8-4"><a href=""></a>    <span class="cf">for</span> tool_call <span class="kw">in</span> tool_calls:</span>
<span id="cb8-5"><a href=""></a>        <span class="co"># Check BEFORE executing</span></span>
<span id="cb8-6"><a href=""></a>        loop_check <span class="op">=</span> loop_detector.check_tool_call(</span>
<span id="cb8-7"><a href=""></a>            tool_call.name, <span class="bu">str</span>(tool_call.arguments)</span>
<span id="cb8-8"><a href=""></a>        )</span>
<span id="cb8-9"><a href=""></a></span>
<span id="cb8-10"><a href=""></a>        <span class="cf">if</span> loop_check.is_looping:</span>
<span id="cb8-11"><a href=""></a>            <span class="co"># Inject warning into conversation instead of executing</span></span>
<span id="cb8-12"><a href=""></a>            messages.append({</span>
<span id="cb8-13"><a href=""></a>                <span class="st">"role"</span>: <span class="st">"tool"</span>,</span>
<span id="cb8-14"><a href=""></a>                <span class="st">"content"</span>: <span class="ss">f"LOOP DETECTED: </span><span class="sc">{</span>loop_check<span class="sc">.</span>message<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb8-15"><a href=""></a>            })</span>
<span id="cb8-16"><a href=""></a>            <span class="cf">break</span>  <span class="co"># Skip remaining tool calls this step</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="fragment">
<p>The agent receives the loop warning as if it were a tool result — it can then <strong>change strategy</strong>.</p>
</div>
</section></section>
<section>
<section id="d.-cost-tracking" class="title-slide slide level1 sdaia-dark center" data-background-gradient="linear-gradient(135deg, #00C9A7, #1C355E)">
<h1>D. Cost Tracking</h1>
<p>Monitoring spend per query</p>
</section>
<section id="why-track-cost" class="slide level2">
<h2>Why Track Cost?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Without tracking:</strong></p>
<ul>
<li>“Our AI bill was $500 this month”</li>
<li>“Some queries are expensive but we don’t know which”</li>
<li>No budget enforcement</li>
</ul>
</div><div class="column" style="width:50%;">
<p><strong>With tracking:</strong></p>
<ul>
<li>“Query X cost $2.30 (15 steps)”</li>
<li>“Average cost: $0.12/query”</li>
<li>Budget alerts per query</li>
</ul>
</div></div>
</section>
<section id="cost-tracking-with-litellm" class="slide level2 smaller">
<h2>Cost Tracking with LiteLLM</h2>
<p>LiteLLM provides built-in cost calculation:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href=""></a><span class="im">from</span> litellm <span class="im">import</span> completion_cost</span>
<span id="cb9-2"><a href=""></a></span>
<span id="cb9-3"><a href=""></a>response <span class="op">=</span> completion(model<span class="op">=</span><span class="st">"gpt-4o"</span>, messages<span class="op">=</span>messages)</span>
<span id="cb9-4"><a href=""></a></span>
<span id="cb9-5"><a href=""></a><span class="co"># Get cost from the response</span></span>
<span id="cb9-6"><a href=""></a>cost <span class="op">=</span> completion_cost(completion_response<span class="op">=</span>response)</span>
<span id="cb9-7"><a href=""></a><span class="bu">print</span>(<span class="ss">f"This step cost: $</span><span class="sc">{</span>cost<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="fragment">
<p>Integrate with the tracer:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href=""></a>tracer.log_cost(trace_id, step_number<span class="op">=</span>step, cost_usd<span class="op">=</span>cost)</span>
<span id="cb10-2"><a href=""></a></span>
<span id="cb10-3"><a href=""></a><span class="co"># At the end of the trace:</span></span>
<span id="cb10-4"><a href=""></a><span class="co"># Total Cost: $0.0178  (sum of all steps)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="setting-budget-limits" class="slide level2">
<h2>Setting Budget Limits</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href=""></a><span class="kw">class</span> CostTracker:</span>
<span id="cb11-2"><a href=""></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, budget_limit_usd: <span class="bu">float</span> <span class="op">=</span> <span class="fl">1.0</span>):</span>
<span id="cb11-3"><a href=""></a>        <span class="va">self</span>.budget_limit <span class="op">=</span> budget_limit_usd</span>
<span id="cb11-4"><a href=""></a>        <span class="va">self</span>.total_spent <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb11-5"><a href=""></a></span>
<span id="cb11-6"><a href=""></a>    <span class="kw">def</span> add_cost(<span class="va">self</span>, cost: <span class="bu">float</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb11-7"><a href=""></a>        <span class="va">self</span>.total_spent <span class="op">+=</span> cost</span>
<span id="cb11-8"><a href=""></a>        <span class="cf">if</span> <span class="va">self</span>.total_spent <span class="op">&gt;</span> <span class="va">self</span>.budget_limit:</span>
<span id="cb11-9"><a href=""></a>            <span class="cf">raise</span> BudgetExceededError(</span>
<span id="cb11-10"><a href=""></a>                <span class="ss">f"Query cost $</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>total_spent<span class="sc">:.2f}</span><span class="ss"> "</span></span>
<span id="cb11-11"><a href=""></a>                <span class="ss">f"exceeds budget of $</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>budget_limit<span class="sc">:.2f}</span><span class="ss">"</span></span>
<span id="cb11-12"><a href=""></a>            )</span>
<span id="cb11-13"><a href=""></a>        <span class="cf">return</span> <span class="va">True</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="fragment">
<blockquote>
<p><strong>Production Tip:</strong> Set per-query budgets ($1-5) AND daily budgets ($50-500). A single runaway agent should never bankrupt your project.</p>
</blockquote>
</div>
</section></section>
<section>
<section id="e.-deepeval-for-agents" class="title-slide slide level1 sdaia-dark center" data-background-gradient="linear-gradient(135deg, #1C355E, #9B8EC0)">
<h1>E. DeepEval for Agents</h1>
<p>Production-grade evaluation framework</p>
</section>
<section id="the-evaluation-problem" class="slide level2">
<h2>The Evaluation Problem</h2>
<p>How do you know if your agent is any good?</p>
<ul>
<li><strong>Manual review</strong> doesn’t scale</li>
<li><strong>String matching</strong> can’t evaluate free-text answers</li>
<li><strong>Unit tests</strong> check format, not quality</li>
<li><strong>Custom LLM judges</strong> are hard to maintain and calibrate</li>
</ul>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>The Solution: DeepEval</strong></p>
</div>
<div class="callout-content">
<p>An open-source framework with 50+ research-backed metrics for LLM and agent evaluation. Integrates with pytest for CI/CD workflows.</p>
</div>
</div>
</div>
</div>
</section>
<section id="why-deepeval-for-agents" class="slide level2">
<h2>Why DeepEval for Agents?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Traditional Metrics Fail</strong></p>
<ul>
<li>BLEU/ROUGE: word overlap, not meaning</li>
<li>Accuracy: binary, no nuance</li>
<li>Precision/Recall: not for open-ended outputs</li>
</ul>
</div><div class="column" style="width:50%;">
<p><strong>DeepEval Approach</strong></p>
<ul>
<li>LLM-as-Judge with calibrated prompts</li>
<li>Agentic metrics: task completion, tool correctness</li>
<li>Component-level evaluation via tracing</li>
</ul>
</div></div>
</section>
<section id="deepeval-agent-metrics" class="slide level2">
<h2>DeepEval Agent Metrics</h2>
<table class="caption-top">
<colgroup>
<col style="width: 25%">
<col style="width: 56%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">What It Measures</th>
<th style="text-align: center;">Mode</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>TaskCompletionMetric</strong></td>
<td style="text-align: left;">Did the agent accomplish the intended task?</td>
<td style="text-align: center;">Standalone or traced</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>ToolCorrectnessMetric</strong></td>
<td style="text-align: left;">Were the right tools called with correct args?</td>
<td style="text-align: center;">Standalone or traced</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>StepEfficiencyMetric</strong></td>
<td style="text-align: left;">Was the execution path optimal?</td>
<td style="text-align: center;"><code>@observe</code> only</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>PlanQualityMetric</strong></td>
<td style="text-align: left;">Was the agent’s plan logical and complete?</td>
<td style="text-align: center;"><code>@observe</code> only</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>PlanAdherenceMetric</strong></td>
<td style="text-align: left;">Did the agent follow its own plan?</td>
<td style="text-align: center;"><code>@observe</code> only</td>
</tr>
</tbody>
</table>
</section>
<section id="llm-tracing-with-observe" class="slide level2">
<h2>LLM Tracing with <span class="citation" data-cites="observe">@observe</span></h2>
<p>DeepEval uses decorators to trace agent components:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12" data-code-line-numbers="|1|3|7|"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href=""></a><span class="im">from</span> deepeval.tracing <span class="im">import</span> observe</span>
<span id="cb12-2"><a href=""></a></span>
<span id="cb12-3"><a href=""></a><span class="at">@observe</span>(metrics<span class="op">=</span>[TaskCompletionMetric(threshold<span class="op">=</span><span class="fl">0.7</span>)])</span>
<span id="cb12-4"><a href=""></a><span class="cf">async</span> <span class="kw">def</span> run_agent(<span class="va">self</span>, query: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb12-5"><a href=""></a>    <span class="co"># Agent loop executes here</span></span>
<span id="cb12-6"><a href=""></a>    <span class="co"># DeepEval captures: steps, tool calls, reasoning</span></span>
<span id="cb12-7"><a href=""></a>    <span class="cf">return</span> final_answer</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Each traced function becomes a <strong>span</strong> — a unit for evaluation.</p>
</section>
<section id="tracing-agent-components" class="slide level2 smaller">
<h2>Tracing Agent Components</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href=""></a><span class="im">from</span> deepeval.tracing <span class="im">import</span> observe, update_current_trace</span>
<span id="cb13-2"><a href=""></a></span>
<span id="cb13-3"><a href=""></a><span class="at">@observe</span>(<span class="bu">type</span><span class="op">=</span><span class="st">"agent"</span>)</span>
<span id="cb13-4"><a href=""></a><span class="kw">class</span> ReactAgent:</span>
<span id="cb13-5"><a href=""></a>    <span class="at">@observe</span>(<span class="bu">type</span><span class="op">=</span><span class="st">"llm"</span>)</span>
<span id="cb13-6"><a href=""></a>    <span class="kw">def</span> call_llm(<span class="va">self</span>, messages): ...</span>
<span id="cb13-7"><a href=""></a>    </span>
<span id="cb13-8"><a href=""></a>    <span class="at">@observe</span>(<span class="bu">type</span><span class="op">=</span><span class="st">"tool"</span>)</span>
<span id="cb13-9"><a href=""></a>    <span class="kw">def</span> execute_tool(<span class="va">self</span>, name, args): ...</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The trace captures the full execution graph for debugging and evaluation.</p>
</section>
<section id="evaluation-with-test-cases" class="slide level2">
<h2>Evaluation with Test Cases</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14" data-code-line-numbers="|1-4|6-8|10-12|"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href=""></a><span class="im">from</span> deepeval <span class="im">import</span> evaluate</span>
<span id="cb14-2"><a href=""></a><span class="im">from</span> deepeval.test_case <span class="im">import</span> LLMTestCase, ToolCall</span>
<span id="cb14-3"><a href=""></a><span class="im">from</span> deepeval.metrics <span class="im">import</span> TaskCompletionMetric, ToolCorrectnessMetric</span>
<span id="cb14-4"><a href=""></a></span>
<span id="cb14-5"><a href=""></a>test_case <span class="op">=</span> LLMTestCase(</span>
<span id="cb14-6"><a href=""></a>    <span class="bu">input</span><span class="op">=</span><span class="st">"What is the population of Paris?"</span>,</span>
<span id="cb14-7"><a href=""></a>    expected_output<span class="op">=</span><span class="st">"approximately 2.1 million"</span>,</span>
<span id="cb14-8"><a href=""></a>    tools_called<span class="op">=</span>[</span>
<span id="cb14-9"><a href=""></a>        ToolCall(name<span class="op">=</span><span class="st">"search"</span>, input_parameters<span class="op">=</span>{<span class="st">"query"</span>: <span class="st">"population of Paris"</span>})</span>
<span id="cb14-10"><a href=""></a>    ]</span>
<span id="cb14-11"><a href=""></a>)</span>
<span id="cb14-12"><a href=""></a></span>
<span id="cb14-13"><a href=""></a>evaluate(</span>
<span id="cb14-14"><a href=""></a>    test_cases<span class="op">=</span>[test_case],</span>
<span id="cb14-15"><a href=""></a>    metrics<span class="op">=</span>[TaskCompletionMetric(), ToolCorrectnessMetric()]</span>
<span id="cb14-16"><a href=""></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="evaluation-results-dashboard" class="slide level2 smaller">
<h2>Evaluation Results Dashboard</h2>
<pre><code>======================================================================
DEEPEVAL EVALUATION RESULTS (5 test cases)
======================================================================
Test Case                      Task Comp  Tool Correct  Step Eff  Overall
---------------------------------------------------------------------
What is the capital of France?    PASS        PASS         -      PASS
Compare Python and JavaScript     PASS        PASS       0.85     PASS
Latest AI research trends         FAIL        PASS       0.62     FAIL
Population of Tokyo metro         PASS        PASS       0.91     PASS
Explain quantum computing         PASS        FAIL       0.78     FAIL
---------------------------------------------------------------------
PASS RATE: 60% (3/5)
Average Step Efficiency: 0.79
======================================================================</code></pre>
</section>
<section id="building-an-evaluation-dataset" class="slide level2">
<h2>Building an Evaluation Dataset</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb16-1"><a href=""></a><span class="fu">{</span></span>
<span id="cb16-2"><a href=""></a>  <span class="dt">"test_cases"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb16-3"><a href=""></a>    <span class="fu">{</span></span>
<span id="cb16-4"><a href=""></a>      <span class="dt">"input"</span><span class="fu">:</span> <span class="st">"What is the population of Tokyo?"</span><span class="fu">,</span></span>
<span id="cb16-5"><a href=""></a>      <span class="dt">"expected_output"</span><span class="fu">:</span> <span class="st">"approximately 14 million"</span><span class="fu">,</span></span>
<span id="cb16-6"><a href=""></a>      <span class="dt">"expected_tools"</span><span class="fu">:</span> <span class="ot">[</span><span class="st">"search"</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb16-7"><a href=""></a>      <span class="dt">"metadata"</span><span class="fu">:</span> <span class="fu">{</span><span class="dt">"category"</span><span class="fu">:</span> <span class="st">"factual"</span><span class="fu">,</span> <span class="dt">"difficulty"</span><span class="fu">:</span> <span class="st">"easy"</span><span class="fu">}</span></span>
<span id="cb16-8"><a href=""></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb16-9"><a href=""></a>    <span class="fu">{</span></span>
<span id="cb16-10"><a href=""></a>      <span class="dt">"input"</span><span class="fu">:</span> <span class="st">"Compare renewable energy policies of EU and US"</span><span class="fu">,</span></span>
<span id="cb16-11"><a href=""></a>      <span class="dt">"expected_output"</span><span class="fu">:</span> <span class="st">"The EU has committed to... while the US..."</span><span class="fu">,</span></span>
<span id="cb16-12"><a href=""></a>      <span class="dt">"expected_tools"</span><span class="fu">:</span> <span class="ot">[</span><span class="st">"search"</span><span class="ot">,</span> <span class="st">"search"</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb16-13"><a href=""></a>      <span class="dt">"metadata"</span><span class="fu">:</span> <span class="fu">{</span><span class="dt">"category"</span><span class="fu">:</span> <span class="st">"comparison"</span><span class="fu">,</span> <span class="dt">"difficulty"</span><span class="fu">:</span> <span class="st">"hard"</span><span class="fu">}</span></span>
<span id="cb16-14"><a href=""></a>    <span class="fu">}</span></span>
<span id="cb16-15"><a href=""></a>  <span class="ot">]</span></span>
<span id="cb16-16"><a href=""></a><span class="fu">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="cicd-integration" class="slide level2">
<h2>CI/CD Integration</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href=""></a><span class="co"># test_agent.py - runs in your CI pipeline</span></span>
<span id="cb17-2"><a href=""></a><span class="im">import</span> pytest</span>
<span id="cb17-3"><a href=""></a><span class="im">from</span> deepeval <span class="im">import</span> assert_test</span>
<span id="cb17-4"><a href=""></a><span class="im">from</span> deepeval.metrics <span class="im">import</span> TaskCompletionMetric</span>
<span id="cb17-5"><a href=""></a></span>
<span id="cb17-6"><a href=""></a><span class="kw">def</span> test_agent_factual_queries():</span>
<span id="cb17-7"><a href=""></a>    test_case <span class="op">=</span> LLMTestCase(</span>
<span id="cb17-8"><a href=""></a>        <span class="bu">input</span><span class="op">=</span><span class="st">"What is the capital of France?"</span>,</span>
<span id="cb17-9"><a href=""></a>        expected_output<span class="op">=</span><span class="st">"Paris"</span></span>
<span id="cb17-10"><a href=""></a>    )</span>
<span id="cb17-11"><a href=""></a>    assert_test(test_case, [TaskCompletionMetric(threshold<span class="op">=</span><span class="fl">0.8</span>)])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Best Practice</strong></p>
</div>
<div class="callout-content">
<p>Maintain a <strong>living eval dataset</strong> (20-50 examples). Run evals on every PR. “It feels better” becomes “task completion improved from 72% to 89%.”</p>
</div>
</div>
</div>
</div>
</section>
<section id="embedding-based-metrics" class="slide level2">
<h2>Embedding-Based Metrics</h2>
<p>When LLM-as-Judge is too expensive or slow:</p>
<table class="caption-top">
<colgroup>
<col style="width: 25%">
<col style="width: 56%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">What It Measures</th>
<th style="text-align: left;">Cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>RetrievalRelevanceMetric</strong></td>
<td style="text-align: left;">Avg cosine similarity: query ↔︎ retrieved chunks</td>
<td style="text-align: left;">$0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>ContextCoverageMetric</strong></td>
<td style="text-align: left;">How well retrieved chunks cover expected contexts</td>
<td style="text-align: left;">$0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>AnswerSimilarityMetric</strong></td>
<td style="text-align: left;">Cosine similarity: expected ↔︎ actual answer</td>
<td style="text-align: left;">$0</td>
</tr>
</tbody>
</table>
<div class="fragment">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href=""></a><span class="im">from</span> evaluation.embedding_metrics <span class="im">import</span> get_embedding_metrics</span>
<span id="cb18-2"><a href=""></a></span>
<span id="cb18-3"><a href=""></a>relevance, coverage, answer <span class="op">=</span> get_embedding_metrics(</span>
<span id="cb18-4"><a href=""></a>    relevance_threshold<span class="op">=</span><span class="fl">0.25</span>,</span>
<span id="cb18-5"><a href=""></a>    coverage_threshold<span class="op">=</span><span class="fl">0.4</span></span>
<span id="cb18-6"><a href=""></a>)</span>
<span id="cb18-7"><a href=""></a></span>
<span id="cb18-8"><a href=""></a>result <span class="op">=</span> relevance.evaluate(query_embedding, retrieved_embeddings)</span>
<span id="cb18-9"><a href=""></a><span class="co"># Offline, no API calls, instant feedback</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="test-case-management" class="slide level2">
<h2>Test Case Management</h2>
<p>Structure your evaluation data:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19" data-code-line-numbers="|1-5|7-12|"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href=""></a>test_cases <span class="op">=</span> [</span>
<span id="cb19-2"><a href=""></a>    {</span>
<span id="cb19-3"><a href=""></a>        <span class="st">"input"</span>: <span class="st">"What is the capital of France?"</span>,</span>
<span id="cb19-4"><a href=""></a>        <span class="st">"expected_output"</span>: <span class="st">"Paris"</span>,</span>
<span id="cb19-5"><a href=""></a>        <span class="st">"expected_tools"</span>: [<span class="st">"search"</span>],</span>
<span id="cb19-6"><a href=""></a>        <span class="st">"category"</span>: <span class="st">"factual"</span>,</span>
<span id="cb19-7"><a href=""></a>        <span class="st">"difficulty"</span>: <span class="st">"easy"</span></span>
<span id="cb19-8"><a href=""></a>    },</span>
<span id="cb19-9"><a href=""></a>    {</span>
<span id="cb19-10"><a href=""></a>        <span class="st">"input"</span>: <span class="st">"Compare the population of Tokyo and Paris"</span>,</span>
<span id="cb19-11"><a href=""></a>        <span class="st">"expected_output"</span>: <span class="st">"Tokyo: 14M, Paris: 2.1M"</span>,</span>
<span id="cb19-12"><a href=""></a>        <span class="st">"expected_tools"</span>: [<span class="st">"search"</span>, <span class="st">"search"</span>],</span>
<span id="cb19-13"><a href=""></a>        <span class="st">"category"</span>: <span class="st">"multi_step"</span></span>
<span id="cb19-14"><a href=""></a>    }</span>
<span id="cb19-15"><a href=""></a>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="fragment">
<p>Load and save with helper functions:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href=""></a><span class="im">from</span> evaluation.test_cases <span class="im">import</span> load_test_cases, save_test_cases</span>
<span id="cb20-2"><a href=""></a></span>
<span id="cb20-3"><a href=""></a>cases <span class="op">=</span> load_test_cases(<span class="st">"test_cases.json"</span>)</span>
<span id="cb20-4"><a href=""></a>save_test_cases(new_cases, <span class="st">"updated_test_cases.json"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="evaluation-runner-pattern" class="slide level2">
<h2>Evaluation Runner Pattern</h2>
<p>Production-ready evaluation workflow:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21" data-code-line-numbers="|1-3|5-7|9-11|"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href=""></a><span class="co"># 1. Run evaluation from file</span></span>
<span id="cb21-2"><a href=""></a>results <span class="op">=</span> run_evaluation_from_file(</span>
<span id="cb21-3"><a href=""></a>    agent, <span class="st">"test_cases.json"</span>, threshold<span class="op">=</span><span class="fl">0.7</span></span>
<span id="cb21-4"><a href=""></a>)</span>
<span id="cb21-5"><a href=""></a></span>
<span id="cb21-6"><a href=""></a><span class="co"># 2. Generate human-readable report</span></span>
<span id="cb21-7"><a href=""></a>report <span class="op">=</span> create_evaluation_report(results, output_file<span class="op">=</span><span class="st">"report.md"</span>)</span>
<span id="cb21-8"><a href=""></a></span>
<span id="cb21-9"><a href=""></a><span class="co"># 3. CI/CD integration</span></span>
<span id="cb21-10"><a href=""></a><span class="co"># python run_eval.py --test-cases test_cases.json --output report.md</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>CLI for Evaluation</strong></p>
</div>
<div class="callout-content">
<p>Use Typer to build evaluation CLIs with <code>--model</code>, <code>--threshold</code>, and <code>--output</code> flags. Run evals in CI pipelines before every merge.</p>
</div>
</div>
</div>
</div>
</section>
<section id="deepeval-vs-custom-evaluation" class="slide level2">
<h2>DeepEval vs Custom Evaluation</h2>
<table class="caption-top">
<colgroup>
<col style="width: 20%">
<col style="width: 53%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Aspect</th>
<th style="text-align: left;">Custom LLM-as-Judge</th>
<th style="text-align: left;">DeepEval</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Metric quality</td>
<td style="text-align: left;">Depends on your prompt</td>
<td style="text-align: left;">Research-backed, calibrated</td>
</tr>
<tr class="even">
<td style="text-align: left;">Maintenance</td>
<td style="text-align: left;">You own the prompts</td>
<td style="text-align: left;">Community + Confident AI</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Agentic metrics</td>
<td style="text-align: left;">Build from scratch</td>
<td style="text-align: left;">6+ agent-specific metrics</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tracing</td>
<td style="text-align: left;">Manual instrumentation</td>
<td style="text-align: left;"><code>@observe</code> decorator</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CI/CD integration</td>
<td style="text-align: left;">Custom scripts</td>
<td style="text-align: left;">pytest native</td>
</tr>
</tbody>
</table>
</section></section>
<section>
<section id="f.-wrap-up" class="title-slide slide level1 sdaia-dark center" data-background-gradient="linear-gradient(135deg, #1C355E, #00C9A7)">
<h1>F. Wrap-up</h1>

</section>
<section id="key-takeaways" class="slide level2">
<h2>Key Takeaways</h2>
<ol type="1">
<li><strong>Tracing is non-negotiable</strong> — every step, every tool call, every cost</li>
<li><strong>Loop detection</strong> uses three strategies: exact, fuzzy, and stagnation</li>
<li><strong>Circuit breakers</strong> inject loop warnings into the conversation</li>
<li><strong>Cost tracking</strong> prevents runaway spending with per-query budgets</li>
<li><strong>DeepEval</strong> provides production-grade metrics and tracing for agent evaluation</li>
<li><strong>Embedding-based metrics</strong> enable offline, cost-free evaluation</li>
<li><strong>Test case management</strong> with JSON datasets scales evaluation efforts</li>
<li><strong>CLI runners</strong> make evaluation CI/CD-ready</li>
</ol>
</section>
<section id="lab-preview-the-broken-agent" class="slide level2">
<h2>Lab Preview: The Broken Agent</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Step 1: Instrumentation</strong></p>
<ul>
<li>Inject <code>AgentTracer</code> into ReactAgent</li>
<li>Run a query that triggers a loop</li>
</ul>
<p><strong>Step 2: Diagnosis</strong></p>
<ul>
<li>Read the trace JSON/logs</li>
<li>Identify the repeating tool calls</li>
</ul>
</div><div class="column" style="width:50%;">
<p><strong>Step 3: The Fix</strong></p>
<ul>
<li>Implement a circuit breaker</li>
<li>Add loop detection to the agent loop</li>
</ul>
<p><strong>Step 4: Verify with DeepEval</strong></p>
<ul>
<li>Run evaluation with <code>run_eval.py</code> CLI</li>
<li>Load test cases from <code>test_cases.json</code></li>
<li>Generate evaluation report</li>
</ul>
</div></div>
<div class="fragment">
<p><strong>Time:</strong> 75 minutes</p>
</div>
</section>
<section id="questions" class="slide level2" data-background-gradient="linear-gradient(135deg, #1C355E, #9B8EC0)">
<h2>Questions?</h2>
<div class="r-fit-text">
<p>Session 3 Complete</p>
</div>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../../slides_template/assets/sdaia.svg" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="03_observability_and_evaluation_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="03_observability_and_evaluation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="03_observability_and_evaluation_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="03_observability_and_evaluation_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="03_observability_and_evaluation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="03_observability_and_evaluation_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="03_observability_and_evaluation_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="03_observability_and_evaluation_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="03_observability_and_evaluation_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="03_observability_and_evaluation_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"},{"title":"Index","icon":"<svg width='1.8rem' viewBox='0 0 24 24'><path d='M5 7h14M5 12h14M5 17h7' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/></svg>","src":"../../index.html"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: false,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>